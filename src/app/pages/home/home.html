<ion-header>
	<ion-navbar color="primary">
		<ion-title *ngIf="currentAssignment">
			{{currentAssignment.driver_truck_assignment.truck.registration}} ({{'HOME.ORDER'|translate}} {{currentAssignment.reference}})
		</ion-title>
		<ion-buttons start>
			<button *ngIf="currentUser" ion-button icon-only (click)="logout()">
				{{currentUser.username}}
				<ion-icon name="log-out"></ion-icon>
			</button>
			<button ion-button icon-only (click)="load()">
				<ion-icon name="refresh"></ion-icon>
			</button>
		</ion-buttons>
	</ion-navbar>
</ion-header>

<ion-content padding>

	<!-- contingencies -->
	<div *ngIf="!currentAssignment">
		<div class="aligner">
			<div class="aligner-item">
				<h1><ion-icon name="information-circle"></ion-icon></h1>
				<h1>{{'HOME.NO_ORDER_MSG'|translate}}</h1>

			</div>
		</div>
	</div>

	<!-- <div *ngIf="!currentWaypoint">
		 {{'HOME.NO_MORE_WAYPOINTS_MSG'|translate}}
		 </div> -->
	
	<!-- waypoint cards -->
	<div *ngIf="currentAssignment">
		<ion-card class="previousCard" [ngClass]="{'unexpected': !previousWaypoint.scheduled}" *ngIf="previousWaypoint">
			<ion-card-header>
				<ion-icon name="{{previousWaypointIconName}}" item-start small></ion-icon> {{'HOME.PREVIOUS_WAYPOINT'|translate}}: {{previousWaypointLocationText}}
			</ion-card-header>
			<ion-card-content>
				<h2>{{previousWaypoint.location.name}}</h2>
				<p>{{previousWaypoint.location.number}} {{previousWaypoint.location.street}}</p>
				<p>{{previousWaypoint.location.city}} {{previousWaypoint.location.postcode}} {{previousWaypoint.location.country_code}}</p>
				<p>{{previousWaypointDatestring}}</p>
			</ion-card-content>
		</ion-card>

		<current-waypoint [currentWaypoint]="currentWaypoint" [currentAssignment]="currentAssignment" (waypointUpdated)="load()"></current-waypoint>
		
		<ion-card class="nextCard" *ngIf="nextWaypoint">
			<ion-card-header>
				<ion-icon name="{{nextWaypointIconName}}" item-start small></ion-icon> {{'HOME.NEXT_WAYPOINT'|translate}}: {{nextWaypointLocationText}}
			</ion-card-header>
			<ion-card-content>
				<h2>{{nextWaypoint.location.name}}</h2>
				<p>{{nextWaypoint.location.number}} {{nextWaypoint.location.street}}</p>
				<p>{{nextWaypoint.location.city}} {{nextWaypoint.location.postcode}} {{nextWaypoint.location.country_code}}</p>
				<p>{{nextWaypointDatestring}}</p>
			</ion-card-content>
		</ion-card>
	</div>
	
	<ion-footer>
		<ion-toolbar>
			<button *ngIf="currentWaypoint && currentWaypoint.actual_date == null && currentWaypoint.scheduled" [navPush]="waypointFormPage" [navParams]="{ currentAssignment: currentAssignment }" ion-button block>{{'HOME.NEW_WAYPOINT'|translate}}</button>
		</ion-toolbar>
	</ion-footer>
</ion-content>
